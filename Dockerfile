# --- Этап 1: Базовый образ ---
# Мы берем официальный образ Python версии 3.9. Это легковесная версия (slim).
# Это гарантирует, что на любой машине будет одинаковая версия Python.
FROM python:3.9-slim

# --- Этап 2: Установка рабочей директории ---
# Создаем папку /app внутри контейнера, где будет жить наш проект.
WORKDIR /app

# --- Этап 3: Установка зависимостей ---
# Копируем ТОЛЬКО файл с зависимостями. Это делается для оптимизации кеширования.
# Если мы не меняем requirements.txt, Docker не будет переустанавливать библиотеки каждый раз.
COPY requirements.txt .

# Запускаем команду pip install для установки всего, что перечислено в requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# --- Этап 4: Копирование кода проекта ---
# Теперь копируем все остальные файлы из нашей папки в рабочую директорию /app контейнера.
# Точка "." означает "все файлы из текущей папки".
COPY . .

# --- Этап 5: Указание команды для запуска ---
# Это команда, которая будет выполнена по умолчанию при запуске контейнера.
# Мы указываем, что нужно запустить наш скрипт predict.py.
# ENTRYPOINT позволяет передавать аргументы командной строки (наши --snow_depth и т.д.)
# напрямую в команду docker run.
ENTRYPOINT ["python", "predict.py"]