# Прогнозирование паводков в Казахстане с использованием машинного обучения

## О проекте

Этот проект был выполнен в рамках курса "AI Engineer" и представляет собой исследование по созданию модели машинного обучения для прогнозирования весенних паводков в регионах Казахстана. Проблема паводков является крайне актуальной для страны, нанося ежегодный экономический и социальный ущерб. Цель проекта — разработать Proof-of-Concept (PoC) модель, способную предсказывать риск паводка на основе метеорологических данных.

## Жизненный цикл ML-проекта

В ходе работы были пройдены все основные этапы разработки ML-проекта:
1.  **Сбор данных:** Собраны исторические данные о фактах паводков из открытых источников и детализированные погодные данные с портала `visualcrossing.com`.
2.  **Feature Engineering:** Ежедневные погодные данные были агрегированы в сезонные признаки (сумма снега, средняя температура и т.д.).
3.  **Обучение моделей:** Были обучены и сравнены две модели: `LogisticRegression` (как baseline) и `XGBoost`.
4.  **Интерпретация:** Проведен глубокий анализ моделей с помощью библиотеки `SHAP` для понимания их внутреннего устройства.
5.  **Упаковка:** Финальная модель упакована в Docker-контейнер для обеспечения воспроизводимости и легкого запуска.

## Ключевые выводы

*   Доказана принципиальная возможность прогнозирования паводков на основе погодных данных.
*   Неожиданный, но важный результат: простая и интерпретируемая модель **Logistic Regression** оказалась более надежной для данной задачи, чем сложный **XGBoost**. Из-за дисбаланса классов XGBoost научился всегда предсказывать отсутствие паводка, что недопустимо в задаче с высокой ценой ошибки.
*   SHAP-анализ показал, что модели выучили логичные физические зависимости (влияние снега, осадков и температуры на риск паводка).

## Как запустить проект

### 1. Локальный запуск (через Python)

Клонируйте репозиторий и установите зависимости:
```bash
git clone https://github.com/Kairat09/kazakhstan-flood-prediction.git
cd kazakhstan-flood-prediction
pip install -r requirements.txt

Запустите скрипт для предсказания, передав параметры погоды:

# Пример для "тревожного" сценария
python predict.py --snow_depth 50 --total_snow 400 --max_precip 20

# Пример для "спокойного" сценария
python predict.py --snow_depth 10 --total_snow 100 --max_precip 5

2. Запуск через Docker (Рекомендуемый способ)
Убедитесь, что у вас установлен и запущен Docker Desktop.
Соберите Docker-образ:

docker build -t flood-predictor .

Запустите контейнер с нужными параметрами:

docker run flood-predictor --snow_depth 50 --total_snow 400 --max_precip 20

Структура репозитория
flood-analysis.ipynb: Jupyter Notebook со всем процессом исследования, от анализа данных до интерпретации моделей.
predict.py: Скрипт для получения прогноза от обученной модели.
logreg_flood_model.joblib: Сохраненная модель Logistic Regression.
Dockerfile: Файл для сборки Docker-образа.
requirements.txt: Список необходимых Python-библиотек.
.dockerignore: Файл для исключения ненужных файлов из Docker-контекста.
data_weather/: Папка с примерами исходных погодных данных.

